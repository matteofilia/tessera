<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
		<title>Tessera Programming Language</title>
		<link rel="stylesheet" href="styles.css">
		<script
			  src="https://code.jquery.com/jquery-3.7.1.min.js"
			  integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
			  crossorigin="anonymous"></script>
		<script>
			$(document).ready(function() {
				var counter = 0;
				var total_files = 5;

				var API_URL = "http://localhost:8080"
				
				load_file = function() {
					index = (counter % total_files)+1
					example_url = "public/code_examples/example"+index+".tess"
					
					$.ajax({
						url : example_url,
						dataType: "text",
						success : function(data) {
							$("#input-box").val(data);
						}
					});
				}
				
				$("#button-next").click(function(){
					counter = counter+1;
					load_file()
				})
		
				$("#button-previous").click(function(){
					counter = counter-1;
					load_file()
				});
				
				$("#button-run-code").click(function(){
					var req_url = API_URL+"/lex";
					var data = $("#input-box").val();
					console.log("Sending POST request to "+req_url +" with data "+data);

					$.ajax({
						type: "POST",
						url: req_url,
						data: data,
						contentType: 'text/plain'
					}).done(function(data) {
						$("#output-box").text(data);
					});
				});
				
				$("#popup-close-button").click(function(){
					$("#popup").hide()
				})
				
				load_file()
			})
		</script>
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
	</head>

	<body>
		<h1 id="title">Tessera</h1>
		<div id="popup">
			<div id="popup-header">
				<p id="popup-header-title">Notice</p>
				<p id="popup-close-button">x</p>
			</div>
			<div id="popup-container">
				<p id="popup-text">Tessera is a <span class="span-bold"> work in progress</span> programming language. Not all features have been currently implemented. You are free to try the language in its current state. <span class="span-newline">-Matteo</span></p>
			</div>
		</div>
		<div id="content-holder">
			<div>
				<p class="header">Input</p>
				<textarea id="input-box" rows="20" cols="50"></textarea>
				<div id="action-bar">
					<div id="navigation-controls">
						<input class="button" id="button-previous" type="button" value="Previous"/>
						<input class="button" id="button-next" type="button" value="Next"/>
					</div>
					<input class="button" id="button-run-code" type="button" value="Run Code"/>
				</div>
			</div>
			<div>
				<p class="header">Output</p>
				<div id="output-box">
				</div>
			</div>
		</div>
		<div id="bottom-content-holder">
			<a class='bottom-content-item' href="https://github.com/matteofilia/tessera">View on GitHub</a>
			<p class='bottom-content-item' id="version">ALPHA 0.1.1</p>
			<p class='bottom-content-item' id="label">Matteo's Programming Language</p>
		</div>
	</body>
</html>
